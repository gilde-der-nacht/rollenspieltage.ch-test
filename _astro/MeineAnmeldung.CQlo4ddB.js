import{g as a,c as l,i as g,S as Q,t as d,a as h,b as Y,s as Ze,e as ee,d as Je,f as qe,j as ge,r as j,k as c,l as X,h as W,M as K,n as ce,E as Qe}from"./web.6Yb9eBst.js";import{I as me,B as U,a as Xe,S as Se,b as L}from"./Box.DC_yNawG.js";import{e as be,a as Z,o as E,s as _,b as V,n as A,l as Re,d as et,u as ye,f as ke,c as tt}from"./index.CtmOPR68.js";var nt=d("<h2>Kontaktdaten"),rt=d("<div class=content><small>Deine persönlichen Daten werden ausschliesslich verwendet, um dich über das Programm der Luzerner Rollenspieltage 2024 zu informieren. Nach dem Event werden diese gelöscht."),ae=d("<br>"),ie=d("<div style=margin-block:.5rem;>");function at(e){let n;return[a(nt),a(rt),a(ae),l(me,{label:"Name",name:"name",get value(){return e.save.name},onValueUpdate:t=>e.updateSave("name",t)}),l(Q,{get when(){return e.save.name.trim().length===0},get children(){var t=a(ie);return g(t,l(U,{type:"danger",children:"Dies ist ein Pflichtfeld."})),t}}),a(ae),l(Xe,{label:"E-Mail",name:"email",type:"email",get value(){return e.save.email},onValueUpdate:t=>e.updateSave("email",t),ref(t){var i=n;typeof i=="function"?i(t):n=t}}),l(Q,{get when(){return e.save.email.trim().length===0},get children(){var t=a(ie);return g(t,l(U,{type:"danger",children:"Dies ist ein Pflichtfeld."})),t}}),l(Q,{get when(){return e.save.email.length>0&&n.validity.typeMismatch},get children(){var t=a(ie);return g(t,l(U,{type:"danger",children:"Die Eingabe scheint keine gültige E-Mail-Adresse zu sein."})),t}}),a(ae),l(me,{label:"Handynummer",name:"tel",type:"tel",get value(){return e.save.handynummer},required:!1,onValueUpdate:t=>e.updateSave("handynummer",t)})]}const Ne=be(["SATURDAY","SUNDAY"]);Z(E({uuid:_(),description:V(_()),title:V(_()),system:_(),master:E({first:_(),last:V(_())}),playerCount:E({min:A(),max:A()}),slot:E({day:Ne,start:A(),end:A()})}));const xe=be(["INITIALIZED","IN_PROGRESS","CONFIRMED","CONFIRMED_W_INVALID_CHANGES","CONFIRMED_W_VALID_CHANGES","RECONFIRMED"]),Ce=E({game:_(),self:Re(!0),spielerName:et()}),Ee=E({game:_(),self:Re(!1),spielerName:_()}),it=ye([Ce.extend({id:A()}),Ee.extend({id:A()})]),lt=ye([Ce,Ee]),st=E({registrationId:A(),progress:xe,name:_(),email:_(),handynummer:_(),wantsEmailUpdates:ke(),games:Z(it),lastSaved:_()});E({registrationId:A(),progress:xe,name:_(),email:_(),handynummer:_(),wantsEmailUpdates:ke(),games:Z(lt),lastSaved:_()});async function ut(e){const n=new URL("https://elysium.gildedernacht.ch/rst24/load");n.searchParams.append("secret",e);const t=await fetch(n);if(!t.ok)return{kind:"FAILED"};const i=await t.json(),s=st.safeParse(i);return s.success?{kind:"SUCCESS",save:s.data}:{kind:"FAILED"}}const dt=E({uuid:_(),title:V(_()),system:_(),description:V(_()),playerCount:E({min:A(),max:A()}),master:E({first:_(),last:V(_())}),slot:E({day:Ne,start:A(),end:A()})}),gt=E({id:A(),gameId:_()});async function ot(){const e=new URL("https://elysium.gildedernacht.ch/rst24/program"),n=new URL("https://elysium.gildedernacht.ch/rst24/reserved"),[t,i]=await Promise.all([fetch(e),fetch(n)]);if(!t.ok)return{kind:"FAILED"};if(!i.ok)return{kind:"FAILED"};const s=await t.json(),r=await i.json(),u=Z(dt).safeParse(s);if(!u.success)return{kind:"FAILED"};const o=Z(gt).safeParse(r);return o.success?{kind:"SUCCESS",program:{gameList:u.data,reservedList:o.data}}:{kind:"FAILED"}}function Ae(e,n){const i=n.gameList.filter(r=>r.slot.day===e).map(r=>{const u=r.uuid,o=n.reservedList.filter(v=>v.gameId===u);return{...r,reservedIds:o.map(v=>v.id)}});let s={};for(const r of i){const{start:u}=r.slot,o=s[u]??[];o.push(r),s[u]=o}return Object.entries(s)}var ct=d("<label class=input-checkbox><input type=checkbox><!$><!/>");function mt(e){return(()=>{var n=a(ct),t=n.firstChild,i=t.nextSibling,[s,r]=h(i.nextSibling);return t.addEventListener("change",u=>e.onValueUpdate(u.target.checked)),g(n,()=>e.label,s,r),Y(()=>Ze(t,"name",e.name)),Y(()=>ee(t,"value",e.value)),Y(()=>ee(t,"checked",e.checked)),n})()}var vt=d("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;align-items:center;><p><strong></strong></p>|<small><!$><!/> bis <!$><!/> Uhr"),$t=d("<p><small>"),ht=d("<small><!$><!/> - <!$><!/> Uhr"),ft=d("<h4 style=margin-block-end:0.5rem;>"),_t=d("<p>Wir kochen: <span>");function te(e){const n=e.type==="LUNCH"?13:18,t=e.type==="LUNCH"?14:19,i=e.small===!0,s=e.type==="LUNCH"?"Mittagessen":"Nachtessen";return i?l(U,{get children(){return[(()=>{var r=a(vt),u=r.firstChild,o=u.firstChild,v=u.nextSibling,m=v.nextSibling,f=m.firstChild,[$,S]=h(f.nextSibling),b=$.nextSibling,R=b.nextSibling,[N,w]=h(R.nextSibling);return N.nextSibling,g(o,s),g(m,n,$,S),g(m,t,N,w),r})(),(()=>{var r=a($t),u=r.firstChild;return ee(u,"innerHTML","Pilzrisotto (vegi&nbsp;/&nbsp;vegan), Penne All'Arrabbiata und Penne Pesto (vegi&nbsp;/&nbsp;vegan)."),r})()]}}):l(U,{get children(){return[(()=>{var r=a(ht),u=r.firstChild,[o,v]=h(u.nextSibling),m=o.nextSibling,f=m.nextSibling,[$,S]=h(f.nextSibling);return $.nextSibling,g(r,n,o,v),g(r,t,$,S),r})(),(()=>{var r=a(ft);return g(r,s),r})(),(()=>{var r=a(_t),u=r.firstChild,o=u.nextSibling;return ee(o,"innerHTML","Pilzrisotto (vegi&nbsp;/&nbsp;vegan), Penne All'Arrabbiata und Penne Pesto (vegi&nbsp;/&nbsp;vegan)."),r})()]}})}var St=d("<li><h1 class=event-title></h1><div class=event-details><div class=event-tags><strong>Zeit:</strong> <!$><!/> - <!$><!/> Uhr</div><div class=event-tags><strong>Spielleitung:</strong> <!$><!/> <!$><!/></div><div class=event-tags><strong>Freie Plätze:</strong> <!$><!/></div><!$><!/></div><div class=event-description><!$><!/><!$><!/></div><!$><!/>"),bt=d("<span>Es hat noch <strong><!$><!/> Plätze</strong> frei."),Rt=d("<span>Es hat noch <strong><!$><!/> Platz</strong> frei."),yt=d("<div class=event-tags style=display:block;><em>(Du hast dich bereits für eine Spielrunde eingetragen, die diese Spielrunde zeitlich überschneidet.)"),kt=d('<div class="event-description content"><p><strong>Beschreibung:</strong><br><!$><!/>'),Nt=d("<div><p><strong>Deine Reservationen</strong></p><ul>"),xt=d("<li style=font-size:0.83rem;>"),Ct=d("<s>"),ve=d('<span title="ungespeicherte Änderung"> *'),Et=d('<a href=javascript:; style=border:none; title="Reservation löschen"><i class="fa-duotone fa-circle-xmark">'),At=d("<ul role=list class=event-links><li><a class=event-link href=javascript:;>+ Platz für mich reservieren"),Tt=d("<ul role=list class=event-links><li><a class=event-link href=javascript:;>+ Platz für Begleitung reservieren"),Dt=d("<h3 style=margin-block:1rem;>Start <!$><!/> Uhr"),Ut=d("<ul class=event-list role=list>"),wt=d(`<style>
          .event-filters .active {
            color: var(--clr-success-10) !important;
          }
        `),Ft=d("<div class=content><small>Auf dieser Seite kannst du dich und deine Freunde für Spielrunden einschreiben, solange es freie Plätze hat."),$e=d("<br>"),pt=d("<div class=event-filters><h2>Filter</h2><ul role=list><li><a href=javascript:;>Alle</a></li><!$><!/>"),he=d("<div style=margin-block:2rem;>"),It=d("<li><a href=javascript:;><!$><!/> Uhr");const Ot=1;function q(e,n){const{from:t,to:i}=n;return t<=e&&e<=i}function Pt(e,n){const{from:t,to:i}=e,{from:s,to:r}=n;return q(t,n)||q(i,n)||q(s,e)||q(r,e)}function Lt(e){function n(){return[...e.confirmedReservations.map(s=>({name:s.spielerName??e.selfName,confirmed:!0,gameUuid:e.entry.uuid,reservationId:s.id,markedForDeletion:e.markedForDeletionReservations.includes(s.id)})),...e.tentativeReservations.map(s=>({name:s.friendsName??e.selfName,confirmed:!1,gameUuid:e.entry.uuid,markedForDeletion:!1}))]}function t(){const s=e.confirmedReservations.map(u=>u.id),r=e.entry.reservedIds.filter(u=>!s.includes(u));return e.entry.playerCount.max-Ot-r.length-n().filter(u=>!u.markedForDeletion).length}function i(){const{start:s,end:r}=e.entry.slot;return e.reservedTimeRanges.filter(o=>Pt({from:s,to:r},o.range)).filter(o=>o.gameUuid!==e.entry.uuid).length===0}return(()=>{var s=a(St),r=s.firstChild,u=r.nextSibling,o=u.firstChild,v=o.firstChild,m=v.nextSibling,f=m.nextSibling,[$,S]=h(f.nextSibling),b=$.nextSibling,R=b.nextSibling,[N,w]=h(R.nextSibling);N.nextSibling;var x=o.nextSibling,G=x.firstChild,P=G.nextSibling,I=P.nextSibling,[H,M]=h(I.nextSibling),z=H.nextSibling,ne=z.nextSibling,[Ue,we]=h(ne.nextSibling),re=x.nextSibling,Fe=re.firstChild,pe=Fe.nextSibling,Ie=pe.nextSibling,[Oe,Pe]=h(Ie.nextSibling),Le=re.nextSibling,[Ge,He]=h(Le.nextSibling),J=u.nextSibling,Me=J.firstChild,[oe,Be]=h(Me.nextSibling),Ye=oe.nextSibling,[Ve,ze]=h(Ye.nextSibling),je=J.nextSibling,[We,Ke]=h(je.nextSibling);return g(r,()=>e.entry.title===null?e.entry.system:`${e.entry.title} (${e.entry.system})`),g(o,()=>e.entry.slot.start,$,S),g(o,()=>e.entry.slot.end,N,w),g(x,()=>e.entry.master.first,H,M),g(x,()=>e.entry.master.last,Ue,we),g(re,(()=>{var F=c(()=>t()>1);return()=>F()?(()=>{var T=a(bt),y=T.firstChild,D=y.nextSibling,k=D.firstChild,[C,O]=h(k.nextSibling);return C.nextSibling,g(D,t,C,O),T})():(()=>{var T=c(()=>t()===1);return()=>T()?(()=>{var y=a(Rt),D=y.firstChild,k=D.nextSibling,C=k.firstChild,[O,p]=h(C.nextSibling);return O.nextSibling,g(k,t,O,p),y})():"Diese Spielrunde ist bereits voll besetzt."})()})(),Oe,Pe),g(u,(()=>{var F=c(()=>t()>0&&!i());return()=>F()?a(yt):null})(),Ge,He),g(J,(()=>{var F=c(()=>e.entry.description!==null&&e.entry.description.trim().length>0);return()=>F()?(()=>{var T=a(kt),y=T.firstChild,D=y.firstChild,k=D.nextSibling,C=k.nextSibling,[O,p]=h(C.nextSibling);return g(y,()=>e.entry.description,O,p),T})():null})(),oe,Be),g(J,(()=>{var F=c(()=>n().length>0);return()=>F()?(()=>{var T=a(Nt),y=T.firstChild,D=y.nextSibling;return g(D,()=>n().map(k=>(()=>{var C=a(xt);return g(C,(()=>{var O=c(()=>!!k.markedForDeletion);return()=>O()?[(()=>{var p=a(Ct);return g(p,()=>k.name),p})(),a(ve)]:[c(()=>k.name),c(()=>c(()=>!!k.confirmed)()?null:a(ve)),(()=>{var p=a(Et);return p.$$click=()=>e.deleteReservation(k),j(),p})()]})()),C})())),T})():null})(),Ve,ze),g(s,(()=>{var F=c(()=>!!(t()>0&&i()));return()=>F()?(()=>{var T=c(()=>n().filter(y=>!y.markedForDeletion).length===0);return()=>T()?(()=>{var y=a(At),D=y.firstChild,k=D.firstChild;return k.$$click=()=>e.addTentativeReservation({gameUuid:e.entry.uuid,friendsName:null}),j(),y})():(()=>{var y=a(Tt),D=y.firstChild,k=D.firstChild;return k.$$click=()=>{const C=prompt("Bitte teile uns mit, wie deine Begleitung heisst:");C!==null&&C.trim().length>0&&e.addTentativeReservation({gameUuid:e.entry.uuid,friendsName:C})},j(),y})()})():null})(),We,Ke),Y(()=>ge(s,`event-entry ${n().filter(F=>!F.markedForDeletion).length>0?"success":t()>0&&i()?"special":"gray"}`)),s})()}function Gt(e){const n=e.confirmedReservations.filter(r=>!e.markedForDeletionReservations.includes(r.id)).map(r=>r.game);n.push(...e.tentativeReservations.map(r=>r.gameUuid));const t=new Set(n);return e.programByHour.flatMap(([r,u])=>u).filter(r=>t.has(r.uuid)).map(r=>({range:{from:r.slot.start,to:r.slot.end},gameUuid:r.uuid}))}function Ht(e){const n={MORNING:[],AFTERNOON:[],EVENING:[]};return e.forEach(t=>{const i=Number(t[0]);i<13?n.MORNING.push(t):i<18?n.AFTERNOON.push(t):n.EVENING.push(t)}),n}function Te(e){const[n,t]=qe([]);function i(m){t(f=>f.includes(m)?f.filter($=>$!==m):[...f,m])}const s=()=>Gt({programByHour:e.programByHour,confirmedReservations:e.confirmedReservations,tentativeReservations:e.tentativeReservations,markedForDeletionReservations:e.markedForDeletionReservations}),{MORNING:r,AFTERNOON:u,EVENING:o}=Ht(e.programByHour);function v(m){return c(()=>m.program.filter(([f])=>n().includes(f)||n().length===0).map(([f,$])=>[(()=>{var S=a(Dt),b=S.firstChild,R=b.nextSibling,[N,w]=h(R.nextSibling);return N.nextSibling,g(S,f,N,w),S})(),(()=>{var S=a(Ut);return g(S,()=>$.map(b=>l(Lt,{entry:b,get selfName(){return e.selfName},get confirmedReservations(){return e.confirmedReservations.filter(R=>R.game===b.uuid)},get tentativeReservations(){return e.tentativeReservations.filter(R=>R.gameUuid===b.uuid)},get markedForDeletionReservations(){return e.markedForDeletionReservations},get reservedTimeRanges(){return s()},get addTentativeReservation(){return e.addTentativeReservation},get deleteReservation(){return e.deleteReservation}}))),S})()]))}return[a(wt),a(Ft),a($e),l(mt,{get checked(){return e.wantsEmailUpdates},onValueUpdate:m=>e.updateSave("wantsEmailUpdates",m),label:"Ja, ich möchte gerne Updates erhalten, wenn neue Spielrunden aufgeschalten werden.",name:"wantsUpdates",value:"true"}),a($e),(()=>{var m=a(pt),f=m.firstChild,$=f.nextSibling,S=$.firstChild,b=S.firstChild,R=S.nextSibling,[N,w]=h(R.nextSibling);return b.$$click=()=>t([]),g($,()=>e.programByHour.map(([x,G])=>(()=>{var P=a(It),I=P.firstChild,H=I.firstChild,[M,z]=h(H.nextSibling);return M.nextSibling,I.$$click=()=>i(x),g(I,x,M,z),Y(()=>ge(I,n().includes(x)?"active":"")),j(),P})()),N,w),Y(()=>ge(b,n().length===0?"active":"")),j(),m})(),l(v,{program:r}),(()=>{var m=a(he);return g(m,l(te,{type:"LUNCH"})),m})(),l(v,{program:u}),c(()=>c(()=>o.length>0)()?[(()=>{var m=a(he);return g(m,l(te,{type:"DINNER"})),m})(),l(v,{program:o})," "]:null)]}Je(["click"]);function Mt(e){const n=Ae("SATURDAY",e.program);return l(Te,{get selfName(){return e.selfName},programByHour:n,get confirmedReservations(){return e.confirmedReservations},get tentativeReservations(){return e.tentativeReservations},get markedForDeletionReservations(){return e.markedForDeletionReservations},get wantsEmailUpdates(){return e.wantsEmailUpdates},get addTentativeReservation(){return e.addTentativeReservation},get updateSave(){return e.updateSave},get deleteReservation(){return e.deleteReservation}})}function Bt(e){const n=Ae("SUNDAY",e.program);return l(Te,{get selfName(){return e.selfName},programByHour:n,get confirmedReservations(){return e.confirmedReservations},get tentativeReservations(){return e.tentativeReservations},get markedForDeletionReservations(){return e.markedForDeletionReservations},get wantsEmailUpdates(){return e.wantsEmailUpdates},get addTentativeReservation(){return e.addTentativeReservation},get updateSave(){return e.updateSave},get deleteReservation(){return e.deleteReservation}})}var Yt=d("<p><strong><!$><!/> </strong>| <!$><!/>, <!$><!/> bis <!$><!/> Uhr"),Vt=d("<p>Reservation für <strong>"),zt=d("<ul role=list style=display:grid;gap:.5rem;>"),jt=d("<li>"),fe=d("<div style=max-inline-size:60ch;>"),Wt=d("<h3>Kontaktdaten"),Kt=d("<ul><li><strong>Name:</strong> <!$><!/></li><li><strong>E-Mail:</strong> <!$><!/></li><li><strong>Handynummer:</strong> <!$><!/>"),_e=d("<br>"),Zt=d("<h3>Deine Reservationen"),Jt=d("<h3>Updates"),qt=d("<p><em>"),Qt=d("<p><em>Noch keine Reservationen getätigt."),Xt=d("<h4>Unbestätigt"),en=d("<p>Bitte speichere deinen aktuellen Stand der Anmeldung, damit wir die folgenden Reservationen bestätigen können."),le=d("<h5>Samstag, 24. August 2024"),se=d("<h5>Sonntag, 25. August 2024"),tn=d("<h4>Reservationen, die du entfernen möchtest"),nn=d("<p>Bitte speichere deinen aktuellen Stand der Anmeldung, damit wir die folgenden Reservationen entfernen können."),rn=d("<h4>Bestätigt"),an=d("<span style=color:var(--clr-success-10);>Ja, ich möchte gerne Updates erhalten, wenn neue Spielrunden aufgeschalten werden."),ln=d("<span style=color:var(--clr-danger-10);>Nein, ich möchte keine E-Mails über neue Spielrunden erhalten.");function sn(e){const{game:n}=e;return l(U,{get type(){return e.type??"gray"},get children(){return[(()=>{var t=a(Yt),i=t.firstChild,s=i.firstChild,[r,u]=h(s.nextSibling);r.nextSibling;var o=i.nextSibling,v=o.nextSibling,[m,f]=h(v.nextSibling),$=m.nextSibling,S=$.nextSibling,[b,R]=h(S.nextSibling),N=b.nextSibling,w=N.nextSibling,[x,G]=h(w.nextSibling);return x.nextSibling,g(i,()=>n.title===null?n.system:`${n.title} (${n.system})`,r,u),g(t,()=>n.slot.day==="SATURDAY"?"Samstag":"Sonntag",m,f),g(t,()=>n.slot.start,b,R),g(t,()=>n.slot.end,x,G),t})(),(()=>{var t=a(Vt),i=t.firstChild,s=i.nextSibling;return g(s,()=>e.players.join(", ")),t})()]}})}function ue(e,n){const t=[],i=[];for(const s of e){const r=n.gameList.find(u=>u.uuid===s.gameUuid);r?.slot.day==="SATURDAY"&&t.push({reservation:s,game:r}),r?.slot.day==="SUNDAY"&&i.push({reservation:s,game:r})}return{SATURDAY:t.toSorted((s,r)=>s.game.slot.start<r.game.slot.start?-1:1),SUNDAY:i.toSorted((s,r)=>s.game.slot.start<r.game.slot.start?-1:1)}}function un(e,n){const t=Object.groupBy(e,i=>i.game.uuid);return Object.values(t).map(i=>{const s=i?.[0];return i===void 0||s===void 0?null:{game:s.game,players:i.map(r=>r.reservation.friendsName??n)}}).filter(i=>i!==null)}function dn(e){const n={MORNING:[],AFTERNOON:[],EVENING:[]};return e.forEach(t=>{const i=t.game.slot.start;i<13?n.MORNING.push(t):i<18?n.AFTERNOON.push(t):n.EVENING.push(t)}),n}function B(e){const n=un(e.entries,e.selfName),{MORNING:t,AFTERNOON:i,EVENING:s}=dn(n),r=e.entries[0]?.game.slot.day==="SATURDAY";function u(o){return(()=>{var v=a(zt);return g(v,()=>o.entries.map(m=>(()=>{var f=a(jt);return g(f,l(sn,{get game(){return m.game},get players(){return m.players},get type(){return e.type}})),f})())),v})()}return[c(()=>c(()=>t.length>0)()?l(u,{entries:t}):null),c(()=>c(()=>t.length>0||i.length>0)()?(()=>{var o=a(fe);return g(o,l(te,{type:"LUNCH",small:!0})),o})():null),c(()=>c(()=>i.length>0)()?l(u,{entries:i}):null),c(()=>c(()=>!!(r&&(i.length>0||s.length>0)))()?(()=>{var o=a(fe);return g(o,l(te,{type:"DINNER",small:!0})),o})():null),c(()=>c(()=>s.length>0)()?l(u,{entries:s}):null)]}function gn(e){const{con:n,del:t}=e.save.games.reduce((u,o)=>e.markedForDeletionReservations.includes(o.id)?{...u,del:[...u.del,o]}:{...u,con:[...u.con,o]},{con:[],del:[]}),i=ue(n.map(u=>({gameUuid:u.game,friendsName:u.spielerName})),e.program),s=ue(t.map(u=>({gameUuid:u.game,friendsName:u.spielerName})),e.program),r=ue(e.tentativeReservations,e.program);return[a(Wt),(()=>{var u=a(Kt),o=u.firstChild,v=o.firstChild,m=v.nextSibling,f=m.nextSibling,[$,S]=h(f.nextSibling),b=o.nextSibling,R=b.firstChild,N=R.nextSibling,w=N.nextSibling,[x,G]=h(w.nextSibling),P=b.nextSibling,I=P.firstChild,H=I.nextSibling,M=H.nextSibling,[z,ne]=h(M.nextSibling);return g(o,()=>e.save.name,$,S),g(b,()=>e.save.email,x,G),g(P,()=>e.save.handynummer,z,ne),u})(),a(_e),a(Zt),c(()=>c(()=>e.save.games.length===0&&e.tentativeReservations.length===0)()?a(Qt):null),c(()=>c(()=>e.tentativeReservations.length>0)()?[a(Xt),a(en),c(()=>c(()=>r.SATURDAY.length>0)()?[a(le),l(B,{get entries(){return r.SATURDAY},get selfName(){return e.save.name},type:"special"})]:null),c(()=>c(()=>r.SUNDAY.length>0)()?[a(se),l(B,{get entries(){return r.SUNDAY},get selfName(){return e.save.name},type:"special"})]:null)]:null),c(()=>c(()=>t.length>0)()?[a(tn),a(nn),c(()=>c(()=>s.SATURDAY.length>0)()?[a(le),l(B,{get entries(){return s.SATURDAY},get selfName(){return e.save.name},type:"danger"})]:null),c(()=>c(()=>s.SUNDAY.length>0)()?[a(se),l(B,{get entries(){return s.SUNDAY},get selfName(){return e.save.name},type:"danger"})]:null)]:null),c(()=>c(()=>n.length>0)()?[a(rn),c(()=>c(()=>i.SATURDAY.length>0)()?[a(le),l(B,{get entries(){return i.SATURDAY},get selfName(){return e.save.name},type:"success"})]:null),c(()=>c(()=>i.SUNDAY.length>0)()?[a(se),l(B,{get entries(){return i.SUNDAY},get selfName(){return e.save.name},type:"success"})]:null)]:null),a(_e),a(Jt),(()=>{var u=a(qt),o=u.firstChild;return g(o,(()=>{var v=c(()=>!!e.save.wantsEmailUpdates);return()=>v()?a(an):a(ln)})()),u})()]}var on=d("<ul role=list style=display:flex;flex-wrap:wrap;column-gap:1rem;row-gap:.5rem;><li></li><li></li><li></li><li>"),cn=d("<div style=display:flex;justify-content:space-between;><div></div><div>"),mn=d("<div style=display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;gap:1rem;><div>Zuletzt gespeichert am <!$><!/></div><div style=display:flex;flex-wrap:wrap;gap:1rem;align-items:center;margin-left:auto;><p><em><small></small></em></p><!$><!/>"),vn=d('<div style="padding-block:2rem 1rem;position:sticky;bottom:0;background-image:linear-gradient(transparent, var(--clr-3) 25%);">'),$n=d("<div style=padding-block:1rem;>"),hn=d("<h2>Programm Samstag"),fn=d("<h2>Programm Sonntag"),_n=d("<div class=content><h2>Zusammenfassung</h2><small>Hier hast du die komplette Übersicht über alle deine Eingaben. Du kannst bis am <strong>Freitag, 23. August 2024</strong> zurückkommen und deine Kontaktdaten und Reservationen anpassen.</small><!$><!/>");function Sn(e){return(()=>{var n=a(on),t=n.firstChild,i=t.nextSibling,s=i.nextSibling,r=s.nextSibling;return g(t,l(L,{label:"Kontaktdaten",get kind(){return e.activeTab==="Contact"?"special":"gray"},onClick:()=>e.changeTab("Contact")})),g(i,l(L,{label:"Programm Samstag",get kind(){return e.activeTab==="Saturday"?"special":"gray"},onClick:()=>e.changeTab("Saturday")})),g(s,l(L,{label:"Program Sonntag",get kind(){return e.activeTab==="Sunday"?"special":"gray"},onClick:()=>e.changeTab("Sunday")})),g(r,l(L,{label:"Zusammenfassung",get kind(){return e.activeTab==="Summary"?"special":"gray"},onClick:()=>e.changeTab("Summary")})),n})()}function bn(e){function n(){switch(e.activeTab){case"Saturday":e.changeTab("Contact");break;case"Sunday":e.changeTab("Saturday");break;case"Summary":e.changeTab("Sunday");break}}function t(){switch(e.activeTab){case"Contact":e.changeTab("Saturday");break;case"Saturday":e.changeTab("Sunday");break;case"Sunday":e.changeTab("Summary");break}}return(()=>{var i=a(cn),s=i.firstChild,r=s.nextSibling;return g(s,(()=>{var u=c(()=>e.activeTab!=="Contact");return()=>u()?l(L,{label:"<< Vorheriger Schritt",onClick:n}):null})()),g(r,(()=>{var u=c(()=>e.activeTab!=="Summary");return()=>u()?l(L,{label:"Nächster Schritt >>",onClick:t}):null})()),i})()}function Rn(e){const n=new Intl.DateTimeFormat("de-CH",{timeStyle:"short",dateStyle:"long"});return l(Se,{get type(){return e.state==="HAS_CHANGES"?"success":"gray"},get children(){var t=a(mn),i=t.firstChild,s=i.firstChild,r=s.nextSibling,[u,o]=h(r.nextSibling),v=i.nextSibling,m=v.firstChild,f=m.firstChild,$=f.firstChild,S=m.nextSibling,[b,R]=h(S.nextSibling);return g(i,()=>n.format(new Date(e.lastSaved)),u,o),g($,()=>e.state==="NO_CHANGES"?"keine Änderungen entdeckt":e.state==="HAS_CHANGES"?"ungespeicherte Änderungen entdeckt":""),g(v,l(L,{get disabled(){return e.state!=="HAS_CHANGES"},get label(){return e.state==="NO_CHANGES"?"Gespeichert.":e.state==="SAVING"?"Wird gespeichert...":"Speichern"},get kind(){return e.state==="HAS_CHANGES"?"success":"gray"},get onClick(){return e.saveCurrentState}}),b,R),t}})}function yn(e){return[l(Sn,{get activeTab(){return e.activeTab},get changeTab(){return e.changeTab}}),(()=>{var n=a($n);return g(n,l(Se,{get children(){return[c(()=>c(()=>e.activeTab==="Contact")()?l(at,{get save(){return e.save},get updateSave(){return e.updateSave}}):c(()=>e.activeTab==="Saturday")()?[a(hn),l(X,{get fallback(){return l(U,{children:"Programm wird geladen ..."})},get children(){return l(W,{get children(){return l(K,{get when(){return e.programResource()},children:t=>l(Mt,{get selfName(){return e.save.name},get program(){return t()},get wantsEmailUpdates(){return e.save.wantsEmailUpdates},get confirmedReservations(){return e.confirmedReservations},get tentativeReservations(){return e.tentativeReservations},get markedForDeletionReservations(){return e.markedForDeletionReservations},get addTentativeReservation(){return e.addTentativeReservation},get updateSave(){return e.updateSave},get deleteReservation(){return e.deleteReservation}})})}})}})]:c(()=>e.activeTab==="Sunday")()?[a(fn),l(X,{get fallback(){return l(U,{children:"Programm wird geladen ..."})},get children(){return l(W,{get children(){return l(K,{get when(){return e.programResource()},children:t=>l(Bt,{get selfName(){return e.save.name},get program(){return t()},get wantsEmailUpdates(){return e.save.wantsEmailUpdates},get confirmedReservations(){return e.confirmedReservations},get tentativeReservations(){return e.tentativeReservations},get markedForDeletionReservations(){return e.markedForDeletionReservations},get addTentativeReservation(){return e.addTentativeReservation},get updateSave(){return e.updateSave},get deleteReservation(){return e.deleteReservation}})})}})}})]:(()=>{var t=a(_n),i=t.firstChild,s=i.nextSibling,r=s.nextSibling,[u,o]=h(r.nextSibling);return g(t,l(X,{get fallback(){return l(U,{children:"Zusammenfassung wird geladen ..."})},get children(){return l(W,{get children(){return l(K,{get when(){return e.programResource()},children:v=>l(gn,{get save(){return e.save},get tentativeReservations(){return e.tentativeReservations},get program(){return v()},get markedForDeletionReservations(){return e.markedForDeletionReservations}})})}})}}),u,o),t})()),(()=>{var t=a(vn);return g(t,l(Rn,{get lastSaved(){return e.lastSaved},get saveCurrentState(){return e.saveCurrentState},get state(){return e.saveState}})),t})()]}})),n})(),l(bn,{get activeTab(){return e.activeTab},get changeTab(){return e.changeTab}})]}function kn(){const e=new URL(location.href),n=e.searchParams.get("secret"),t=e.searchParams.get("showCreateMessage")==="true";return{secret:n,showCreateMessage:t}}async function De(e){if(e.secret===null)throw Error("SECRET_ERROR");const n=await ut(e.secret);if(n.kind==="FAILED")throw Error("SECRET_ERROR");return{state:"IDLE",secret:e.secret,showCreateMessage:e.showCreateMessage,currentSave:n.save,activeTab:"Contact",lastSaved:n.save.lastSaved,hasChanged:!1,tentativeReservations:[],markedForDeletionReservations:[]}}async function Nn(){const e=await ot();if(e.kind==="FAILED")throw Error("PROGRAM_ERROR");return e.program}function xn(e){const[n,t]=tt(e);function i(v){t("activeTab",v),window.scrollTo({top:0})}function s(v,m){t("hasChanged",!0),t("currentSave",v,m)}async function r(){if(n.state!=="IDLE")throw Error("ASSERTION_ERROR");t("state","SAVING");const v=new URL("https://elysium.gildedernacht.ch/rst24/save"),m={...n.currentSave,games:[...n.currentSave.games.filter($=>!n.markedForDeletionReservations.includes($.id)),...n.tentativeReservations.map($=>$.friendsName===null?{game:$.gameUuid,self:!0,spielerName:null}:{game:$.gameUuid,self:!1,spielerName:$.friendsName})]};if((await fetch(v,{method:"post",body:JSON.stringify(m),headers:{"Content-Type":"application/json"}})).ok){const $=await De({secret:n.secret,showCreateMessage:!1});t({...$,activeTab:n.activeTab})}else throw Error("SAVE_ERROR")}function u(v){t("hasChanged",!0),t("tentativeReservations",m=>[...m,v])}function o(v){if(t("hasChanged",!0),v.confirmed)t("markedForDeletionReservations",m=>[...m,v.reservationId]);else{const m=n.currentSave.name;t("tentativeReservations",f=>f.filter($=>$.gameUuid!==v.gameUuid?!0:$.friendsName===v.name?!1:v.name!==m))}}return{state:n,actions:{changeTab:i,updateSave:s,saveCurrentState:r,addTentativeReservation:u,deleteReservation:o}}}var de=d("<br>"),Cn=d("<strong>Freitag, 23. August 2024"),En=d("<p>Wir konnten leider keine Anmeldung finden. Wenn du bereits eine Anmeldung begonnen hast, solltest du den korrekten Link per E-Mail erhalten haben.<br><br> Falls du noch keine Anmeldung begonnen hast, kannst du <a href=/anmeldung>hier</a> deine persönliche Anmeldung beginnen. <br><br>Für generelle Fragen oder Probleme, schreibe uns doch bitte über unser <a href=/kontatk>Kontaktformular</a>."),An=d("<p>Leider ist ein unerwarteter Fehler passiert. Versuche deine Anmeldung erneut zu laden. Wiederholt sich dieser Fehler, bitte kontaktiere uns sobald als möglich über das <a href=/kontakt>Kontaktformular</a>, da dies nicht passieren sollte."),Tn=d("<p>Deine Anmeldung wird geladen...");function Dn(e){const{state:n,actions:t}=xn(e.state);return[l(Q,{get when(){return n.showCreateMessage},get children(){return[l(U,{type:"success",get children(){return["Deine Anmeldung wurde erfolgreich gestartet.",a(de),a(de),"Wir haben eine E-Mail an deine Adresse gesendet. In dieser E-Mail findest du einen persönlichen Link, um deine Anmeldung bis am"," ",a(Cn)," anzupassen."]}}),a(de)]}}),l(yn,{get activeTab(){return n.activeTab},get changeTab(){return t.changeTab},get save(){return n.currentSave},get updateSave(){return t.updateSave},get lastSaved(){return n.lastSaved},get saveCurrentState(){return t.saveCurrentState},get saveState(){return n.state==="SAVING"?"SAVING":n.hasChanged?"HAS_CHANGES":"NO_CHANGES"},get programResource(){return e.programResource},get confirmedReservations(){return n.currentSave.games},get tentativeReservations(){return n.tentativeReservations},get addTentativeReservation(){return t.addTentativeReservation},get deleteReservation(){return t.deleteReservation},get markedForDeletionReservations(){return n.markedForDeletionReservations}})]}function pn(){const e=kn(),[n]=ce(()=>De(e)),[t]=ce(()=>Nn());return l(Qe,{fallback:i=>l(U,{type:"danger",get children(){return l(W,{get fallback(){return a(An)},get children(){return l(K,{get when(){return i.message==="SECRET_ERROR"},get children(){return a(En)}})}})}}),get children(){return l(X,{get fallback(){return l(U,{get children(){return a(Tn)}})},get children(){return l(W,{get children(){return l(K,{get when(){return n()},children:i=>l(Dn,{get state(){return i()},programResource:t})})}})}})}})}export{pn as MeineAnmeldung};
